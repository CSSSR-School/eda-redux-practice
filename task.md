# Рефакторинг транзакции

## Логика транзакции

1. Вводим сумму для оплаты.  
2. Переходим в фазу ввода имени/пароля.  
2.1 При ответах от сервера с ошибкой ошибка выводится снизу.  
2.2 При 5 повторах ошибок форма перезапускается.  
2.3 При успешном логине переходим в 2FA фазу.  
3. Фаза ввода 2FA кода.  
3.1 При ответах от сервера с ошибкой ошибка выводится снизу.  
3.2 При 5 повторах ошибок форма возвращается в фазу ввода имени/пароля.  
3.3 При успешном прохождении 2FA переходим в фазу успешного завершения.

## План на рефакторинг

Сейчас логика транзакции расползлась по контейрнеру (компонент не должен отвечать за эту логику, состояние не локализовано в той мере в какой могло быть). Необходимо вынести и локализовать её в каком-то redux-middleware подходящем для этих целей (redux-saga или rxjs). Также из-за этого сейчас возможно выполняются лишние диспатчи в стор.

## Критерий выполнения

В контейнере присутствует только логика получения данных из стора и диспатчей экшенов в стор. Редьюсеры должны остаться чистыми функциями. Состояние транзакции которое не связано с отображением должно быть инкапсулировано, сейчас оно просачивается в контейнер.  

Для отображения важны только

```
paymentState: paymentState.amountSelection,
error: null,
amount: 0,
```

Любое другое состояние транзакции может быть инкапсулировано в саге/потоке.
